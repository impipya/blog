<!DOCTYPE html>
<html lang="en">
  <head>
              <title>impipya - é…ç½®ä»£ç† ç»ˆçº§ ä¸­çº§æŒ‡å—</title>
      <meta charset="utf-8" />
      <meta name="generator" content="Pelican" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="/theme/css/main.css" />

        <meta name="tags" content="Docker"/>
        <meta name="tags" content="publishing"/>
  </head>

  <body>
      <header>
    <nav><ul>
        <li id="site"><a href="/">impipya</a></li>
                <li><a href="/category/docker.html"  aria-current="page" >Docker</a></li>
    </ul></nav>
      </header>
      <main>
    <article>

        <h1>Docker é…ç½®ä»£ç† <del>ç»ˆçº§</del> ä¸­çº§æŒ‡å—</h1>
<p><img alt="real docker" class="leader_pic" src="https://images-1364006926.cos.ap-shanghai.myqcloud.com/website/real%20docker.jpg"></p>
<h2>ğŸ¥å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæ€ä¹ˆåŠï¼Ÿ</h2>
<p>æ»¡å¿ƒæ¬¢å–œï¼Œåœ¨bare metalæˆ–VPSä¸Šå®‰è£…ä½ å–œçˆ±çš„distributionåï¼Œæ¥ç€æƒ³ä½¿ç”¨Dockeréƒ¨ç½²ä¸€äº›æœåŠ¡ã€‚ä¸ºäº†æµ‹è¯•æ‹‰å–imageåŠŸèƒ½æ˜¯å¦å¯ç”¨ï¼Œäºæ˜¯ä½ è¾“å…¥äº†å¦‚ä¸‹æŒ‡ä»¤[ref]ä½ çœŸçš„è¾“å…¥äº†å¦‚ä¸‹æŒ‡ä»¤ï¼[/ref]ï¼š</p>
<div class="highlight"><pre><span></span><code>$ sudo docker pull hello-world
</code></pre></div>
<p>åœ¨æ²¡æœ‰ç‰¹æ®Šé…ç½®çš„æƒ…å†µä¸‹ï¼Œä¸”æœ¬åœ°æ²¡æœ‰ä¹‹å‰æ‹‰å–è¿‡é•œåƒçš„ç¼“å­˜ï¼Œåœ¨ç­‰å¾…äº†å‡ ç§’é’Ÿåï¼ŒDockersä¸€èˆ¬ä¼šè¿”å›ç»™ä½ ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<div class="admonition warning">
<p class="admonition-title">ç­‰ç­‰ï¼è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ï¼</p>
<p>ä¸ç”¨å…³å¿ƒè¿™é‡Œçš„å†…å®¹ã€‚</p>
<!-- [Our Menu]({static}/pdfs/menu.pdf) -->
<!-- [Our Menu]({author}impipya) -->
</div>
<div class="highlight"><pre><span></span><code>Using default tag: latest
Error response from daemon: Get &quot;https://registry-1.docker.io/v2/&quot;: context deadline exceeded
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># è¿™é‡Œæ·»åŠ äº†ä¸€ä¸ªpythonä»£ç å—ï¼Œè¿™æ˜¯ä»pelicanæ‹·è´è¿‡æ¥çš„æºç </span>

<span class="k">class</span> <span class="nc">SourceFileGenerator</span><span class="p">(</span><span class="n">Generator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">generate_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_extension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;OUTPUT_SOURCES_EXTENSION&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_create_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">output_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">save_as</span><span class="p">)</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="n">output_path</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_extension</span><span class="p">)</span>
        <span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">source_path</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating source files...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s2">&quot;articles&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s2">&quot;pages&quot;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_source</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">obj_trans</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">translations</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_source</span><span class="p">(</span><span class="n">obj_trans</span><span class="p">)</span>
</code></pre></div>
<p>ç»æŸ¥è¯¢ï¼Œ<code>context deadline exceeded</code>æ˜¯Goè¯­è¨€ä¸­HTTPè¯·æ±‚è¶…æ—¶å‘ç”Ÿçš„é”™è¯¯ï¼Œè€ŒDockeråˆæ˜¯Goè¯­è¨€å†™çš„ï¼Œæ‰€ä»¥è¿™æ˜¾ç„¶ä»£è¡¨Dockerä»official registryçš„hello-world repositoryæ‹‰å–hello-worldé•œåƒè¶…æ—¶äº†â€¦â€¦è€Œè¿™æ—¶åˆå°è¯•äº†å…¶å®ƒçš„é•œåƒï¼Œä¹Ÿéƒ½æ˜¯è¿™ä¸ªæƒ…å†µã€‚</p>
<p>é€ æˆè¯¥ç°è±¡çš„åŸå› æ˜¯ï¼Œå¢ƒå†…å¯¹dockeré»˜è®¤æ‰€é‡‡ç”¨çš„ï¼ˆåŒæ—¶ä¹Ÿæ˜¯æœ€å¤§çš„ï¼‰registryâ€”â€”Docker Hubè¿›è¡Œäº†å±è”½ã€‚æ­¤æ—¶ï¼Œå¦‚æœæƒ³è¦æ‹‰å–åˆ°é•œåƒï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥é‡‡ç”¨ï¼š</p>
<ul>
<li>
<p>é‡‡ç”¨å¢ƒå†…ç”±ä¸ªäººæˆ–ç»„ç»‡æ­å»ºç»´æŠ¤çš„registry mirrorè¿›è¡Œimageæ‹‰å–ã€‚</p>
</li>
<li>
<p>ä¸ºæœºå™¨å’ŒDockeré…ç½®proxyã€‚</p>
</li>
</ul>
<h2>1ï¸âƒ£æ–¹å¼ä¸€ï¼šRegistry Mirror</h2>
<p>æ‰¾åˆ°å¯ç”¨çš„registry mirroråœ°å€ï¼ˆkeywordï¼šdockeråŠ é€Ÿé•œåƒã€docker hub mirrorï¼‰ï¼Œå¹¶éµå¾ª<a href="https://docs.docker.com/docker-hub/image-library/mirror/#configure-the-docker-daemon">Docker DOC: Configure the Docker daemon</a>ä¸­çš„æ­¥éª¤è¿›è¡Œé…ç½®ã€‚åœ¨æ­¤å¯¹æ–‡æ¡£ä¸­çš„å†…å®¹è¿›è¡Œç®€è¿°ï¼Œå¹¶åŠ å…¥ä¿ºæ€»ç»“çš„å°Tipsã€‚</p>
<p>å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å¯¹Dockers Daemonè¿›è¡Œé…ç½®ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>åœ¨ä½¿ç”¨<code>dockerd</code>æŒ‡ä»¤å¯åŠ¨Docker daemonæ—¶ï¼Œé€šè¿‡<code>--registry-mirror</code>é€‰é¡¹ä¼ å…¥mirroråœ°å€è¿›è¡Œé…ç½®ã€‚</li>
<li>ä¿®æ”¹Docker daemonçš„é…ç½®æ–‡ä»¶<a href="https://docs.docker.com/reference/cli/dockerd/#daemon-configuration-file"><code>/etc/docker/daemon.json</code></a>(æ²¡æœ‰åˆ™åˆ›å»º)ï¼Œå¾€å…¶ä¸­<strong>åŠ å…¥</strong><code>registry-mirrors</code>é”®å€¼å¯¹ã€‚å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­æ•°ç»„ä¸­çš„å€¼æ˜¯registry mirrorçš„åœ°å€å­—ç¬¦ä¸²ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;registry-mirrors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;https://&lt;my-docker-mirror-host&gt;&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>é…ç½®å¹¶ä¿å­˜å®Œæ¯•åï¼ˆä»»ä½•å¯¹<code>daemon.json</code>çš„æ›´æ”¹ï¼‰ï¼Œéƒ½éœ€restartï¼ˆreloadå¯ä»¥å—ï¼Ÿè§ä¸‹æ–‡ï¼‰Docker daemonä»¥åˆ·æ–°é…ç½®ï¼š</p>
<div class="highlight"><pre><span></span><code>$ sudo systemctl restart docker
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">ç­‰ç­‰ï¼è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ï¼</p>
<p>ç»è¿‡å®é™…æ£€æµ‹ï¼Œå¯¹äºproxyé…ç½®ï¼Œ<code>systemctl reload</code>ä¸è¶³ä»¥ä½¿æ”¹å˜åçš„<code>daemon.json</code>é…ç½®ç”Ÿæ•ˆã€‚</p>
</div>
<div class="admonition note">
<p class="admonition-title">ç­‰ç­‰ï¼è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ï¼</p>
<p>æœ€ä½³å®è·µï¼šå¯¹äº<code>daemon.json</code>é…ç½®çš„å˜æ›´ï¼Œæ€»æ˜¯ä½¿ç”¨<code>systemctl restart</code>æ¥è¿›è¡Œé‡å¯ã€‚</p>
</div>
<div class="admonition note">
<p class="admonition-title">ç­‰ç­‰ï¼è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ï¼</p>
<p>é€šå¸¸æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨é…ç½®ä¸­å¾€ä¸€ä¸ªæ•°ç»„å†…å¡«å…¥å¤šä¸ªåœ°å€çš„è¡Œä¸ºï¼Œå¦‚ï¼š
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;registry-mirrors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;https://&lt;my-docker-mirror-host_1&gt;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;https://&lt;my-docker-mirror-host_2&gt;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;https://&lt;my-docker-mirror-host_3&gt;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="err">...</span>
<span class="w">    </span><span class="p">],</span>
<span class="p">}</span>
</code></pre></div></p>
<p>ç»è¿‡ï¼ˆç®—ä¸ä¸Šæ˜¯æœ€å…¨é¢çš„ï¼‰æŸ¥è¯¢ï¼Œè¿™ç§æ–¹å¼åœ¨<a href="https://docs.docker.com/docker-hub/image-library/mirror/">Mirror</a>å’Œ<a href="https://docs.docker.com/reference/cli/dockerd/#daemon-configuration-file">Daemon configuration file</a>ä¸­éƒ½æ²¡æœ‰æ˜ç¡®å®šä¹‰ã€‚è€Œåœ¨manæ‰‹å†Œçš„dockerd(8)ä¸­ï¼Œä¹Ÿä»…æœ‰ä¸€æ®µé’ˆå¯¹<code>--registry-mirror</code>é€‰é¡¹çš„æè¿°ï¼š</p>
<div class="highlight"><pre><span></span><code>--registry-mirror=://
      Prepend a registry mirror to be used for image pulls. May be specified
      multiple times.
</code></pre></div>
<p>æ‰€ä»¥å§‘ä¸”æŠŠè¿™ç®—åšä¸€ä¸ªundocumentedï¼ˆè‡³å°‘æ²¡æœ‰æ˜¾è€Œæ˜“è§çš„æ–‡æ¡£ï¼‰çš„ç”¨æ³•ã€‚ä½†æ®è¯´Dockersä¼šåœ¨å‰é¢çš„mirroråœ°å€å¤±æ•ˆæ—¶è‡ªåŠ¨åˆ‡æ¢è‡³é…ç½®ä¸­çš„ä¸‹ä¸€ä¸ªåœ°å€ã€‚</p>
</div>
<h2>2ï¸âƒ£æ–¹å¼äºŒï¼šä½¿ç”¨ Proxy</h2>
<p>çœ‹èµ·æ¥å¤§å¤šæ•°registryé•œåƒç«™éƒ½ä¸å¤ªç¨³å®šã€‚åœ¨é•œåƒç«™ä¸å¯ç”¨æ—¶ï¼Œéœ€è¦ç»è¿‡å¦‚ä¸‹çš„å¾ªç¯æ­¥éª¤ï¼Œæ¥é‡æ–°è·å¾—ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡ï¼š</p>
<div class="highlight"><pre><span></span><code>do {
    å¯»æ‰¾mirror
    é…ç½®mirror
} while mirrorä¸å¯ç”¨
é…ç½®æˆåŠŸ
</code></pre></div>
<p>æ— ç–‘ï¼Œæœ‰æ—¶è¿™ä¸å¤ªæ–¹ä¾¿ã€‚</p>
<p>ç”±äºDocker CLIæ‹‰å–imageæ—¶æ˜¯é€šè¿‡daemonæ¥ä¸Docker Hub registryè¿›è¡Œé€šä¿¡å®Œæˆçš„ï¼Œæ‰€ä»¥ä¸ºdocker daemoné…ç½®ä»£ç†ï¼Œæ¥ç›´æ¥ä»Docker Hubä¸­æ‹‰å–imageï¼Œæ˜¯æœ€ä¸ºä¸€åŠ³æ°¸é€¸çš„åŠæ³•ã€‚ï¼ˆç¡®ä¿ä»£ç†æœåŠ¡å™¨æŒç»­å¯ç”¨ã€‚ï¼‰</p>
<p><a href="https://docs.docker.com/engine/daemon/proxy/">Daemon proxy configuration | Docker Docs</a>ä¸­æœ‰å¯¹Docker daemoné…ç½®proxyçš„è¯¦ç»†æ­¥éª¤ï¼Œåœ¨æ­¤è¿›è¡Œç®€è¿°ï¼ŒåŒæ—¶ä¹ŸåŠ å…¥äº†ä¸€äº›è‡ªå·±æ€»ç»“çš„å°Tipsï¼š</p>
<p>é¦–å…ˆï¼Œä¸ºDocker daemoné…ç½®proxyçš„æ–¹å¼æœ‰ä¸¤ç§ï¼šä¸€æ˜¯é…ç½®<a href="https://docs.docker.com/reference/cli/dockerd/#daemon-configuration-file"><code>/etc/docker/daemon.json</code></a>æ–‡ä»¶ï¼ŒäºŒæ˜¯å¯¹systemd unitæ–‡ä»¶è¿›è¡Œé…ç½®ã€‚</p>
<h3>ğŸ“„é…ç½® daemon.jsonï¼ˆæ–‡æ¡£ä¸­çš„æ¨èåšæ³•ï¼‰</h3>
<p>å¦‚åŒé…ç½®mirrorä¸€æ ·ï¼Œé…ç½®å¯ä»¥åœ¨å¯åŠ¨docker daemonæ—¶ç”±<code>dockerd</code>å‘½ä»¤é€‰é¡¹ä¼ å…¥ï¼Œä¹Ÿå¯åœ¨<a href="https://docs.docker.com/reference/cli/dockerd/#daemon-configuration-file"><code>/etc/docker/daemon.json</code></a>ï¼ˆæ²¡æœ‰åˆ™åˆ›å»ºï¼‰ä¸­é…ç½®ï¼Œéœ€è¦åœ¨æ–‡ä»¶ä¸­æ·»åŠ çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;proxies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;http-proxy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://proxy.example.com:3128&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;https-proxy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://proxy.example.com:3129&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;no-proxy&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*.test.example.com,.example.org,127.0.0.0/8&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>å…¶ä¸­proxyçš„åœ°å€å’Œç«¯å£éœ€è¦æ›´æ®å®é™…æƒ…å†µè‡ªå·±è°ƒæ•´ã€‚åœ¨æ–‡ä»¶ä¿®æ”¹å®Œæ¯•åï¼Œé€šè¿‡<code>dockerd --validate</code>æ£€æŸ¥é…ç½®æ–‡ä»¶ï¼Œç¡®è®¤é…ç½®æ— è¯¯åï¼Œä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤é‡å¯docker daemonï¼š</p>
<div class="highlight"><pre><span></span><code>$ sudo systemctl restart docker
</code></pre></div>
<p>å³å¯ä½¿é…ç½®ç”Ÿæ•ˆã€‚</p>
<div class="admonition note">
<p class="admonition-title">ç­‰ç­‰ï¼è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ï¼</p>
<p><code>dockerd --validate</code>æ— æ³•æ£€æµ‹è·¯å¾„å’Œæ–‡ä»¶åçš„æ­£ç¡®æ€§ã€‚å¦‚æœè·¯å¾„æˆ–æ–‡ä»¶åé”™è¯¯ï¼Œå°†å¯¼è‡´æ£€æµ‹ç»“æœæ€»æ˜¯<code>configuration OK</code>,ä¸”æ˜¾è€Œæ˜“è§é…ç½®ä¸ä¼šç”Ÿæ•ˆã€‚ä¸€å®šè¦æ³¨æ„å“¦ï¼</p>
</div>
<h3>ğŸ“„é…ç½® Systemd Unitæ–‡ä»¶</h3>
<p>åœ¨<a href="https://docs.docker.com/engine/daemon/proxy/">Daemon proxy configuration | Docker Docs</a>ä¸­ï¼Œå¯¹äºé€šè¿‡ä»¥ä¿®æ”¹Systemd Unitæ–‡ä»¶çš„æ–¹å¼æ¥é…ç½®ä»£ç†ï¼Œæœ‰è¿™æ ·ä¸€æ®µè¯´æ˜ï¼š</p>
<blockquote>
<p>The Docker daemon checks the following environment variables in its start-up environment to configure HTTP or HTTPS proxy behavior:</p>
<p>è¯‘ä¸ºï¼šdockerå®ˆæŠ¤è¿›ç¨‹é€šè¿‡æ£€æŸ¥start-up environmentä¸­å¦‚ä¸‹environment variablesæ¥é…ç½®ä»£ç†çš„è¡Œä¸ºï¼š</p>
<ul>
<li><code>HTTP_PROXY</code></li>
<li><code>http_proxy</code></li>
<li><code>HTTPS_PROXY</code></li>
<li><code>https_proxy</code></li>
<li><code>NO_PROXY</code></li>
<li><code>no_proxy</code></li>
</ul>
</blockquote>
<p>ä»è¯­å¢ƒä¸­çœ‹ï¼Œè¿™é‡ŒæŒ‡çš„ä¸æ˜¯bash shellæ¦‚å¿µä¸­çš„ç¯å¢ƒå˜é‡ï¼Œè€Œæ˜¯systemdç¯å¢ƒä¸­çš„ä¸€ä¸ªæ¦‚å¿µã€‚ç»è¿‡å®æµ‹ï¼Œä¹Ÿè¯æ˜äº†bash shellä¸­é…ç½®çš„<code>*_PROXY</code>ã€<code>*_proxy</code>ç¯å¢ƒå˜é‡ç¡®å®ä¸ä¼šå¯¹docker pull imageçš„è¡Œä¸ºäº§ç”Ÿå½±å“ã€‚æ‰€ä»¥ï¼Œæ ¹æ®ä¸‹æ–‡å¯¹docker daemonè¿›è¡Œé…ç½®ï¼Œæ‰å¯ä»¥ä½¿docker CLIä½¿ç”¨ä»£ç†æ¥pull imageã€‚</p>
<p>å…³äºè¯¥é…ç½®è¯¦ç»†çš„è¯­æ³•è¯´æ˜ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://docs.docker.com/engine/daemon/proxy/">Daemon proxy configuration | Docker Docs</a>ï¼Œè¿™é‡Œå¯¹éœ€è¦è¿›è¡Œçš„é…ç½®è¿›è¡Œç®€è¿°ã€‚</p>
<p>é¦–å…ˆåœ¨<code>/etc/systemd/system/docker.service.d/http-proxy.conf</code>æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="k">[Service]</span>
<span class="na">Environment</span><span class="o">=</span><span class="s">&quot;HTTP_PROXY=http://proxy.example.com:3128&quot;</span>
<span class="na">Environment</span><span class="o">=</span><span class="s">&quot;HTTPS_PROXY=https://proxy.example.com:3129&quot;</span>
<span class="na">Environment</span><span class="o">=</span><span class="s">&quot;NO_PROXY=localhost,127.0.0.1,docker-registry.example.com,.corp&quot;</span>
</code></pre></div>
<p>å…¶ä¸­proxyçš„åœ°å€å’Œç«¯å£éœ€è¦æ›´æ®å®é™…æƒ…å†µè‡ªå·±è°ƒæ•´ã€‚</p>
<p>è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤æ¥ä½¿é…ç½®ç”Ÿæ•ˆï¼š</p>
<div class="highlight"><pre><span></span><code>$ sudo systemctl daemon-reload &amp;&amp; sudo systemctl restart docker
</code></pre></div>
<p>é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤æ¥æ£€æµ‹é…ç½®çš„æœ‰æ•ˆæ€§ï¼š</p>
<div class="highlight"><pre><span></span><code>$ sudo systemctl show --property=Environment docker
</code></pre></div>
<p>å¦‚æœé…ç½®æ­£ç¡®ï¼Œä¼šæœ‰ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºï¼š</p>
<div class="highlight"><pre><span></span><code>Environment=HTTP_PROXY=http://proxy.example.com:3128 HTTPS_PROXY=https://proxy.example.com:3129 NO_PROXY=localhost,127.0.0.1,docker-registry.example.com,.corp
</code></pre></div>
<h3>âœ…é…ç½®å®Œæˆä¹‹å</h3>
<p>æ­¤æ—¶åº”è¯¥å°±å¯ä»¥é€šè¿‡<code>docker pull</code>æŒ‡ä»¤æ¥è¿›è¡Œimageçš„æ‹‰å–ï¼š</p>
<div class="highlight"><pre><span></span><code>$ sudo docker pull hello-world
</code></pre></div>
<h2>ğŸš©Beyond</h2>
<p>ä¸Šæ–‡çš„é…ç½®ï¼Œåªä¼šåœ¨é€šè¿‡å‘½ä»¤è¡Œæ‹‰å–é•œåƒæ—¶ç”Ÿæ•ˆï¼Œè€Œä¸ä¼šå½±å“Dockerfileè¿è¡Œæ—¶å’Œå®¹å™¨å†…éƒ¨ç½‘ç»œã€‚ä¸‹ä¸€æ­¥æ˜¯ï¼Œåœ¨Dockerfileè¿è¡Œæ—¶å’Œå®¹å™¨å†…éƒ¨ä½¿ç”¨ä»£ç†ã€‚</p>
<p>[å¾…æ›´æ–°]</p>
<h2>Other</h2>
<ul>
<li>library mirror or registry mirrorï¼Ÿåº”è¯¥å‡†ç¡®è¯´æ˜¯registry mirrorã€‚</li>
<li>imageå’Œmirrorå¦‚æœä¸ä½¿ç”¨è‹±æ–‡çš„åŒ–ï¼Œå°±åªèƒ½é€šè¿‡contextï¼ˆè¯­å¢ƒï¼‰åˆ†æ¸…äº†ã€‚</li>
</ul>

        <footer>
            <p>Published:
                <time datetime="2024-12-03T10:20:00+01:00">Tue 03 December 2024</time>
            </p>

                <p>Last updated:
                    <time datetime="2025-06-05T19:30:00+02:00">
                        Thu 05 June 2025
                    </time>
                </p>

                <address>
                    By                     <a href="/author/impipya.html">impipya</a>
                </address>

                <p>
                    Category: <a href="/category/docker.html">Docker</a>
                </p>

                <p>
                    Tags:
                        <a href="/tag/docker.html">Docker</a>
                        <a href="/tag/publishing.html">publishing</a>
                </p>
        </footer>
    </article>
      </main>
      <footer>
<address>
    Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>,
    which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>,
    theme by <a rel="nofollow" href="">impipya</a>>
</address>
      </footer>
  </body>
</html>